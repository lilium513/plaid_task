var mongo = require('mongodb');

/**
 * Default connection details.
 */

var defaults = {
    host: '127.0.0.1'
  , port: 27017
  , database: 'default'
};

/**
 * Create a MongoDB database connection.
 *
 * @param {Object|String} config (optional)
 * @param {Object} options (optional)
 * @api public
 */

var Database = exports.Database = function (config, options) {
    var database, host, port, self = this;

    config = config || {};
    options = options || {
        auto_reconnect: true
      , poolSize: 8
    };

    if (config.mongodb) {
        config = config.mongodb;
    }
    if (typeof config === 'object') {
        host = config.host || defaults.host;
        port = config.port || defaults.port;
        database = config.database || defaults.database;
    } else {
        //Parse (host)(:port)(/database)
        var match = config.match(/([^:\/]+)?(\:[0-9]+)?(\/.+)?/);
        host = match[1] || defaults.host;
        port = match[2] ? parseInt(match[2].substr(1), 10) : defaults.port;
        data